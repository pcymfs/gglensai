# gglensai

## Usage

Automatic classification of strong gravitational galaxy-galaxy lenses using machine learning.

The main files to use for a test run are:

`[trainImg, trainVal] = img_setup(n);`

which sets up a list of n random images and their corresponding training parameters. 
A sample of the images can be viewed using:
 
`draw_sample(imgs,vals);`
 

The network can be trained using a set of images with:
 
`net = net_setup(trainImg, trainVal);`


The network can then be tested using:
 
`net_test(net, testImg, testVal)`

which will calculate some statistics and display a histogram of the differences between the network output and the generation parameters.


## Image Generation

The `img_setup` function sets up the 4D-array of the images (width,height,colour_channel,image_num), and the 2D training array (image_num,parameter). The individual images are generated by deciding on a set of (mass and luminocity) paramteres for the image and passing them to the `img_gen` function.

The `img_gen` sets up a mesh of pixel coordinates and passes them through `img_lens_raycast` which applies the lensing coordinate transformation before getting the colour values with one of the source image generators `img_source_*`.

The `apply_galaxy` function is used throughout to generate a SÃ©rsic profile evaluated at at each point in a mesh of coordinates.

